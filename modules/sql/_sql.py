import urllib
import pandas as pd
from modules.default import general_widgets
from sqlalchemy import create_engine

# SQL implementation

server = ""
database = ""
username = ""
password = ""
driver = ""
odbc_str = (
    "DRIVER="
    + driver
    + ";SERVER="
    + server
    + ";PORT=;UID="
    + username
    + ";DATABASE="
    + database
    + ";PWD="
    + password
)
connect_str = "mssql+pyodbc:///?odbc_connect=" + urllib.parse.quote_plus(odbc_str)
engine = create_engine(connect_str)


# participant list that stores the full list of available participants for each dataset type

_participant_list = {
    "Proteomics": [
        "CASE-NEUAA295HHE\nCASE-NEUAB000NKC\nCASE-NEUAD542VT0\nCASE-NEUAE228FF6\nCASE-NEUAE993EPR\nCASE-NEUAF553MJ3\nCASE-NEUAG241NUD\nCASE-NEUAG603XLK\nCASE-NEUAG766ULB\nCASE-NEUAK321NN1\nCASE-NEUAK401LJK\nCASE-NEUAL076FCE\nCASE-NEUAL614GYB\nCASE-NEUAP285GGU\nCASE-NEUAT234RK6\nCASE-NEUAW339DLB\nCASE-NEUAW408VMD\nCASE-NEUAW717TN6\nCASE-NEUAX665ZHY\nCASE-NEUAY067UTB\nCASE-NEUAY510EHC\nCASE-NEUAZ394JEZ\nCASE-NEUBA169GXD\nCASE-NEUBC622XYK\nCASE-NEUBC901KL3\nCASE-NEUBC998WWB\nCASE-NEUBD062TJV\nCASE-NEUBD141MGD\nCASE-NEUBD288RXQ\nCASE-NEUBE218XDY\nCASE-NEUBL463FP2\nCASE-NEUBM949LA5\nCASE-NEUBN979ZZ5\nCASE-NEUBT273FH3\nCASE-NEUBW008RJ5\nCASE-NEUBY734PFR\nCASE-NEUCB613CA9\nCASE-NEUCC065VTK\nCASE-NEUCC219HJC\nCASE-NEUCD502BFU\nCASE-NEUCD750HYR\nCASE-NEUCF538BRM\nCASE-NEUCF743MRA\nCASE-NEUCG029WWD\nCASE-NEUCG511MJ6\nCASE-NEUCN596RR3\nCASE-NEUCP068CPY\nCASE-NEUCP218XVV\nCASE-NEUCT022VTK\nCASE-NEUCT440NYE\nCASE-NEUCT842RJV\nCASE-NEUCU076ADN\nCASE-NEUCV578DFJ\nCASE-NEUCW352BPV\nCASE-NEUCW678DB0\nCASE-NEUCX894KE1\nCASE-NEUDE422HTQ\nCASE-NEUDE902GCT\nCASE-NEUDG272XWC\nCASE-NEUDG795CBV\nCASE-NEUDH063DEA\nCASE-NEUDJ536EVH\nCASE-NEUDM949BAR\nCASE-NEUDP155HFH\nCASE-NEUDP959KRY\nCASE-NEUDY534KGP\nCASE-NEUDZ473EGM\nCASE-NEUEA186ZBL\nCASE-NEUEC400NYR\nCASE-NEUEE244GKF\nCASE-NEUEE624VCY\nCASE-NEUEF261XG0\nCASE-NEUEJ957JBT\nCASE-NEUEK191WYC\nCASE-NEUEL515MZ3\nCASE-NEUEN017PCJ\nCASE-NEUET072VDG\nCASE-NEUET956RE3\nCASE-NEUEU318NY2\nCASE-NEUEY478NZP\nCASE-NEUFD119MT2\nCASE-NEUFE455EX1\nCASE-NEUFF238WXM\nCASE-NEUFF278LJX\nCASE-NEUFG869YDY\nCASE-NEUFH461AAN\nCASE-NEUFP476KG9\nCASE-NEUFU395MJD\nCASE-NEUFV237VCZ\nCASE-NEUFX386KMB\nCASE-NEUFZ663LPM\nCASE-NEUGC065VHR\nCASE-NEUGD965XVD\nCASE-NEUGH024UUP\nCASE-NEUGH995TFK\nCASE-NEUGJ714MMC\nCASE-NEUGK693CJZ\nCASE-NEUGL543NJ1\nCASE-NEUGP781PDU\nCASE-NEUGR121TFD\nCASE-NEUGR539MVT\nCASE-NEUGU254CLF\nCASE-NEUGW340YEB\nCASE-NEUHB491NGF\nCASE-NEUHG644RYB\nCASE-NEUHK991AVP\nCASE-NEUHL096UF0\nCASE-NEUHL814WMU\nCASE-NEUHL999WWT\nCASE-NEUHM532NDD\nCASE-NEUHP073VJ7\nCASE-NEUHR975AFM\nCASE-NEUHT569HT1\nCASE-NEUHT665KDA\nCASE-NEUHV216EHA\nCASE-NEUHW152ZWM\nCASE-NEUHW530WD8\nCASE-NEUHW590KBH\nCASE-NEUHY206ZEQ\nCASE-NEUHZ364FZW\nCASE-NEUJA666PYD\nCASE-NEUJC191RLE\nCASE-NEUJE592JXB\nCASE-NEUJG311WGV\nCASE-NEUJG344BTU\nCASE-NEUJG885PY7\nCASE-NEUJH197AK2\nCASE-NEUJH436DPG\nCASE-NEUJK720JCL\nCASE-NEUJL547WVQ\nCASE-NEUJL595JAZ\nCASE-NEUJN816RXV\nCASE-NEUJP437YZ0\nCASE-NEUJP935AVF\nCASE-NEUJT708HZL\nCASE-NEUJV798JGH\nCASE-NEUJX780XXK\nCASE-NEUJX990GR5\nCASE-NEUJY536DKF\nCASE-NEUJZ466JA6\nCASE-NEUKA429GAC\nCASE-NEUKA860NUG\nCASE-NEUKG720EA0\nCASE-NEUKJ497WBB\nCASE-NEUKK433LRC\nCASE-NEUKP160HX8\nCASE-NEUKR376CW3\nCASE-NEUKV547CFA\nCASE-NEUKY696CC9\nCASE-NEUKY704JVA\nCASE-NEUKZ777LWZ\nCASE-NEUKZ850KXU\nCASE-NEULA694DDC\nCASE-NEULA777DBT\nCASE-NEULC015VD9\nCASE-NEULC153TP4\nCASE-NEULD354RZB\nCASE-NEULD729BGF\nCASE-NEULF280XLR\nCASE-NEULH618DXF\nCASE-NEULH729AU2\nCASE-NEULJ823EJD\nCASE-NEULK071LRJ\nCASE-NEULL588ALG\nCASE-NEULM479YNK\nCASE-NEULM691PBK\nCASE-NEULN113GMA\nCASE-NEULP953KE7\nCASE-NEULP998KDJ\nCASE-NEULT851ENP\nCASE-NEULY177TTN\nCASE-NEULY328CRJ\nCASE-NEULZ548ZXV\nCASE-NEUMA411HJP\nCASE-NEUMA640ZBR\nCASE-NEUMB242CLN\nCASE-NEUMC278JK3\nCASE-NEUMD869UV7\nCASE-NEUME498PCJ\nCASE-NEUME929BY2\nCASE-NEUMG659AUL\nCASE-NEUMH556GHC\nCASE-NEUMH634MKT\nCASE-NEUMK513KKZ\nCASE-NEUMN219VGE\nCASE-NEUMN370TMN\nCASE-NEUMN922PMZ\nCASE-NEUMR125ZJ2\nCASE-NEUMT098DUY\nCASE-NEUMT422NBX\nCASE-NEUMW598YMT\nCASE-NEUMW642ATG\nCASE-NEUMX408BMF\nCASE-NEUMY871DGF\nCASE-NEUNG326MFP\nCASE-NEUNJ155KYL\nCASE-NEUNJ938DUL\nCASE-NEUNL303HLF\nCASE-NEUNM920DWJ\nCASE-NEUNP157FRQ\nCASE-NEUNR020KV6\nCASE-NEUNR118PKF\nCASE-NEUNX568KA8\nCASE-NEUNY225WHE\nCASE-NEUNY752LMG\nCASE-NEUNZ171UYF\nCASE-NEUPA955VWR\nCASE-NEUPF731DTB\nCASE-NEUPG593UTV\nCASE-NEUPJ837WUD\nCASE-NEUPK142YFD\nCASE-NEUPK546ZLD\nCASE-NEUPM937TMY\nCASE-NEUPR357AUF\nCASE-NEUPT594ZWP\nCASE-NEUPU527GZL\nCASE-NEUPV284CP1\nCASE-NEUPY050ANK\nCASE-NEURF720KHA\nCASE-NEURJ362MXH\nCASE-NEURJ448YCV\nCASE-NEURR881FKY\nCASE-NEURT008RBN\nCASE-NEURT785NE0\nCASE-NEURX315DYH\nCASE-NEURX909UL6\nCASE-NEUTA057AF6\nCASE-NEUTB230DA3\nCASE-NEUTC791PVE\nCASE-NEUTD314VFT\nCASE-NEUTD866EAH\nCASE-NEUTJ613AH9\nCASE-NEUTJ673HVL\nCASE-NEUTK103LA2\nCASE-NEUTL257PNR\nCASE-NEUTL699WJ0\nCASE-NEUTM459HZV\nCASE-NEUTM934BPY\nCASE-NEUTU360YJY\nCASE-NEUTU977EF8\nCASE-NEUTV502UXV\nCASE-NEUTY409FWN\nCASE-NEUTZ197WN7\nCASE-NEUUC458RFT\nCASE-NEUUD158CJF\nCASE-NEUUE852BB1\nCASE-NEUUF177PR6\nCASE-NEUUF613PHL\nCASE-NEUUH658EYH\nCASE-NEUUJ507EAB\nCASE-NEUUK960PF7\nCASE-NEUUL256UC9\nCASE-NEUUL292XRC\nCASE-NEUUL311NRQ\nCASE-NEUUP280KXL\nCASE-NEUUU506WZF\nCASE-NEUUX639XV0\nCASE-NEUUZ216XY8\nCASE-NEUUZ691KHN\nCASE-NEUVD687XD8\nCASE-NEUVF488XCF\nCASE-NEUVP060WFG\nCASE-NEUVR636VTP\nCASE-NEUVR711TBR\nCASE-NEUVR814YCY\nCASE-NEUVU735HU6\nCASE-NEUVV115HWH\nCASE-NEUVV225XKB\nCASE-NEUVW680LPK\nCASE-NEUVW999FP9\nCASE-NEUVX902YNL\nCASE-NEUVY234LVB\nCASE-NEUWD538KT3\nCASE-NEUWD781PHK\nCASE-NEUWD946RDA\nCASE-NEUWH380YHV\nCASE-NEUWH955FJF\nCASE-NEUWJ389FC7\nCASE-NEUWL486NRA\nCASE-NEUWM344ZLM\nCASE-NEUWN755ZP7\nCASE-NEUWV328FFB\nCASE-NEUWX167DAH\nCASE-NEUWY079WUH\nCASE-NEUWZ387HEM\nCASE-NEUWZ614ARQ\nCASE-NEUWZ822EZ3\nCASE-NEUXC114JYA\nCASE-NEUXD265LJ8\nCASE-NEUXD985ZU1\nCASE-NEUXG265ME9\nCASE-NEUXH833LL4\nCASE-NEUXP246TBM\nCASE-NEUXP289KRC\nCASE-NEUXP369PXA\nCASE-NEUXP495XE2\nCASE-NEUXV122FN3\nCASE-NEUXW790VZK\nCASE-NEUXZ486GG5\nCASE-NEUXZ835CZN\nCASE-NEUYB991JTA\nCASE-NEUYC055XPZ\nCASE-NEUYC198DCR\nCASE-NEUYC303AJY\nCASE-NEUYC651BR2\nCASE-NEUYD306HAB\nCASE-NEUYG208KVV\nCASE-NEUYG298CA9\nCASE-NEUYG636WT7\nCASE-NEUYH924UCE\nCASE-NEUYJ400MGQ\nCASE-NEUYJ705VN9\nCASE-NEUYK012ATK\nCASE-NEUYK029WUU\nCASE-NEUYP226CPW\nCASE-NEUYP235ZLD\nCASE-NEUYR183FYF\nCASE-NEUYT193FFG\nCASE-NEUYY061XMC\nCASE-NEUYY493DR8\nCASE-NEUYY614DN8\nCASE-NEUYY878JGP\nCASE-NEUYZ462TBW\nCASE-NEUZD231YZ6\nCASE-NEUZE432DZM\nCASE-NEUZE814JZF\nCASE-NEUZF321EW4\nCASE-NEUZF473UEP\nCASE-NEUZG964FAV\nCASE-NEUZK054DP5\nCASE-NEUZN936HJ9\nCASE-NEUZP278MR4\nCASE-NEUZP572KEZ\nCASE-NEUZR615PKX\nCASE-NEUZT902WVB\nCASE-NEUZV656DD1\nCASE-NEUZW291KJY\nCASE-NEUZW701NNF\nCASE-NEUZW744ZCD\nCASE-NEUZX521TKK\nCASE-NEUZX663FZ2\nCASE-NEUZX847VWV\nCASE-NEUZY128BJ2\nCASE-NEUZY264DG9\nCASE-NEUZY975XKL\nCTRL-CS007\nCTRL-CW50002FF1\nCTRL-CW50021EE1\nCTRL-CW50027\nCTRL-EDi021A\nCTRL-EDi022A\nCTRL-EDi023A\nCTRL-EDi025A\nCTRL-EDi026A\nCTRL-EDi029A\nCTRL-EDi030A\nCTRL-EDi038A\nCTRL-EDi039A\nCTRL-EDi043A\nCTRL-EDi045A\nCTRL-NEUAA485DZL\nCTRL-NEUAG120VWW\nCTRL-NEUAJ928PAA\nCTRL-NEUAK915RW7\nCTRL-NEUAN478ZLW\nCTRL-NEUBU578NX3\nCTRL-NEUCA748GF2\nCTRL-NEUCE403VM7\nCTRL-NEUCV136DHM\nCTRL-NEUCV809LL4\nCTRL-NEUCX966RX5\nCTRL-NEUDA782GW3\nCTRL-NEUDD665KML\nCTRL-NEUDF148BTJ\nCTRL-NEUDG422NK3\nCTRL-NEUDM126GNG\nCTRL-NEUDT762KUL\nCTRL-NEUDV570JJM\nCTRL-NEUEA702XRF\nCTRL-NEUEB210XRC\nCTRL-NEUEK795BLX\nCTRL-NEUET121DA6\nCTRL-NEUEU392AE8\nCTRL-NEUFK653ZB3\nCTRL-NEUFL733GX5\nCTRL-NEUFU823AF8\nCTRL-NEUGM959DE2\nCTRL-NEUHY905BUE\nCTRL-NEUJH928PGD\nCTRL-NEUJX341NDP\nCTRL-NEULM159CPG\nCTRL-NEUMA002VLD\nCTRL-NEUMC455JAR\nCTRL-NEUMF089KLV\nCTRL-NEUMF196GPV\nCTRL-NEUML507PFJ\nCTRL-NEUML965NXH\nCTRL-NEUMR377JKP\nCTRL-NEUMT184NWC\nCTRL-NEUMV031UD8\nCTRL-NEUNB744CAL\nCTRL-NEUNC876ZB2\nCTRL-NEUNK457XYH\nCTRL-NEUNN472ACB\nCTRL-NEUNW343RXP\nCTRL-NEUPH301NNX\nCTRL-NEUPL878MTL\nCTRL-NEUPM433ADK\nCTRL-NEUPW469XH7\nCTRL-NEUPW536ZKZ\nCTRL-NEUPY789JV6\nCTRL-NEURV546WMW\nCTRL-NEUTD932VFY\nCTRL-NEUTY704UY9\nCTRL-NEUTZ821KW9\nCTRL-NEUUV825HYF\nCTRL-NEUUX563RM1\nCTRL-NEUVW301WP3\nCTRL-NEUVX248UJQ\nCTRL-NEUWN092BVG\nCTRL-NEUWT164JRQ\nCTRL-NEUXC258VTR\nCTRL-NEUXC738FB0\nCTRL-NEUXP955XW7\nCTRL-NEUXU356GN0\nCTRL-NEUXW311EFC\nCTRL-NEUXY894VJR\nCTRL-NEUZA664DNH\nCTRL-NEUZG048FP5\nCTRL-NEUZL045YD3\nCTRL-NEUZX866LAD\nCTRL-W14C179\nCTRL-W14C180\nCTRL-W15C201\nCTRL-W15C202\nCTRL-W16C403"
    ],
    "Transcriptomics": [
        "CASE-NEUAA295HHE\nCASE-NEUAB000NKC\nCASE-NEUAD542VT0\nCASE-NEUAE228FF6\nCASE-NEUAE993EPR\nCASE-NEUAF553MJ3\nCASE-NEUAG241NUD\nCASE-NEUAG603XLK\nCASE-NEUAG766ULB\nCASE-NEUAK321NN1\nCASE-NEUAK401LJK\nCASE-NEUAL076FCE\nCASE-NEUAL614GYB\nCASE-NEUAP285GGU\nCASE-NEUAT234RK6\nCASE-NEUAW339DLB\nCASE-NEUAW408VMD\nCASE-NEUAW717TN6\nCASE-NEUAX665ZHY\nCASE-NEUAY067UTB\nCASE-NEUAY510EHC\nCASE-NEUAZ394JEZ\nCASE-NEUBA169GXD\nCASE-NEUBC622XYK\nCASE-NEUBC901KL3\nCASE-NEUBC998WWB\nCASE-NEUBD062TJV\nCASE-NEUBD141MGD\nCASE-NEUBD288RXQ\nCASE-NEUBE218XDY\nCASE-NEUBL463FP2\nCASE-NEUBM949LA5\nCASE-NEUBN979ZZ5\nCASE-NEUBT273FH3\nCASE-NEUBW008RJ5\nCASE-NEUBY734PFR\nCASE-NEUCB613CA9\nCASE-NEUCC065VTK\nCASE-NEUCC219HJC\nCASE-NEUCD502BFU\nCASE-NEUCD750HYR\nCASE-NEUCF538BRM\nCASE-NEUCF743MRA\nCASE-NEUCG029WWD\nCASE-NEUCG511MJ6\nCASE-NEUCN596RR3\nCASE-NEUCP068CPY\nCASE-NEUCP218XVV\nCASE-NEUCT022VTK\nCASE-NEUCT440NYE\nCASE-NEUCT842RJV\nCASE-NEUCU076ADN\nCASE-NEUCV578DFJ\nCASE-NEUCW352BPV\nCASE-NEUCW678DB0\nCASE-NEUCX894KE1\nCASE-NEUDE422HTQ\nCASE-NEUDE902GCT\nCASE-NEUDG272XWC\nCASE-NEUDG795CBV\nCASE-NEUDH063DEA\nCASE-NEUDJ536EVH\nCASE-NEUDM949BAR\nCASE-NEUDP155HFH\nCASE-NEUDP959KRY\nCASE-NEUDY534KGP\nCASE-NEUDZ473EGM\nCASE-NEUEA186ZBL\nCASE-NEUEC400NYR\nCASE-NEUEE244GKF\nCASE-NEUEE624VCY\nCASE-NEUEF261XG0\nCASE-NEUEJ957JBT\nCASE-NEUEK191WYC\nCASE-NEUEL515MZ3\nCASE-NEUEN017PCJ\nCASE-NEUET072VDG\nCASE-NEUET956RE3\nCASE-NEUEU318NY2\nCASE-NEUEY478NZP\nCASE-NEUFD119MT2\nCASE-NEUFE455EX1\nCASE-NEUFF238WXM\nCASE-NEUFF278LJX\nCASE-NEUFG869YDY\nCASE-NEUFH461AAN\nCASE-NEUFP476KG9\nCASE-NEUFU395MJD\nCASE-NEUFV237VCZ\nCASE-NEUFX386KMB\nCASE-NEUFZ663LPM\nCASE-NEUGC065VHR\nCASE-NEUGD965XVD\nCASE-NEUGH024UUP\nCASE-NEUGH995TFK\nCASE-NEUGJ714MMC\nCASE-NEUGK693CJZ\nCASE-NEUGL543NJ1\nCASE-NEUGP781PDU\nCASE-NEUGR121TFD\nCASE-NEUGR539MVT\nCASE-NEUGU254CLF\nCASE-NEUGW340YEB\nCASE-NEUHB491NGF\nCASE-NEUHG644RYB\nCASE-NEUHK991AVP\nCASE-NEUHL096UF0\nCASE-NEUHL814WMU\nCASE-NEUHL999WWT\nCASE-NEUHM532NDD\nCASE-NEUHP073VJ7\nCASE-NEUHR975AFM\nCASE-NEUHT569HT1\nCASE-NEUHT665KDA\nCASE-NEUHV216EHA\nCASE-NEUHW152ZWM\nCASE-NEUHW530WD8\nCASE-NEUHW590KBH\nCASE-NEUHY206ZEQ\nCASE-NEUHZ364FZW\nCASE-NEUJA666PYD\nCASE-NEUJC191RLE\nCASE-NEUJE592JXB\nCASE-NEUJG311WGV\nCASE-NEUJG344BTU\nCASE-NEUJG885PY7\nCASE-NEUJH197AK2\nCASE-NEUJH436DPG\nCASE-NEUJK720JCL\nCASE-NEUJL547WVQ\nCASE-NEUJL595JAZ\nCASE-NEUJN816RXV\nCASE-NEUJP437YZ0\nCASE-NEUJP935AVF\nCASE-NEUJT708HZL\nCASE-NEUJV798JGH\nCASE-NEUJX780XXK\nCASE-NEUJX990GR5\nCASE-NEUJY536DKF\nCASE-NEUJZ466JA6\nCASE-NEUKA429GAC\nCASE-NEUKA860NUG\nCASE-NEUKG720EA0\nCASE-NEUKJ497WBB\nCASE-NEUKK433LRC\nCASE-NEUKP160HX8\nCASE-NEUKR376CW3\nCASE-NEUKV547CFA\nCASE-NEUKY696CC9\nCASE-NEUKY704JVA\nCASE-NEUKZ777LWZ\nCASE-NEUKZ850KXU\nCASE-NEULA694DDC\nCASE-NEULA777DBT\nCASE-NEULC015VD9\nCASE-NEULC153TP4\nCASE-NEULD354RZB\nCASE-NEULD729BGF\nCASE-NEULF280XLR\nCASE-NEULH618DXF\nCASE-NEULH729AU2\nCASE-NEULJ823EJD\nCASE-NEULK071LRJ\nCASE-NEULL588ALG\nCASE-NEULM479YNK\nCASE-NEULM691PBK\nCASE-NEULN113GMA\nCASE-NEULP953KE7\nCASE-NEULP998KDJ\nCASE-NEULT851ENP\nCASE-NEULY177TTN\nCASE-NEULY328CRJ\nCASE-NEULZ548ZXV\nCASE-NEUMA411HJP\nCASE-NEUMA640ZBR\nCASE-NEUMB242CLN\nCASE-NEUMC278JK3\nCASE-NEUMD869UV7\nCASE-NEUME498PCJ\nCASE-NEUME929BY2\nCASE-NEUMG659AUL\nCASE-NEUMH556GHC\nCASE-NEUMH634MKT\nCASE-NEUMK513KKZ\nCASE-NEUMN219VGE\nCASE-NEUMN370TMN\nCASE-NEUMN922PMZ\nCASE-NEUMR125ZJ2\nCASE-NEUMT098DUY\nCASE-NEUMT422NBX\nCASE-NEUMW598YMT\nCASE-NEUMW642ATG\nCASE-NEUMX408BMF\nCASE-NEUMY871DGF\nCASE-NEUNG326MFP\nCASE-NEUNJ155KYL\nCASE-NEUNJ938DUL\nCASE-NEUNL303HLF\nCASE-NEUNM920DWJ\nCASE-NEUNP157FRQ\nCASE-NEUNR020KV6\nCASE-NEUNR118PKF\nCASE-NEUNX568KA8\nCASE-NEUNY225WHE\nCASE-NEUNY752LMG\nCASE-NEUNZ171UYF\nCASE-NEUPA955VWR\nCASE-NEUPF731DTB\nCASE-NEUPG593UTV\nCASE-NEUPJ837WUD\nCASE-NEUPK142YFD\nCASE-NEUPK546ZLD\nCASE-NEUPM937TMY\nCASE-NEUPR357AUF\nCASE-NEUPT594ZWP\nCASE-NEUPU527GZL\nCASE-NEUPV284CP1\nCASE-NEUPY050ANK\nCASE-NEURF720KHA\nCASE-NEURJ362MXH\nCASE-NEURJ448YCV\nCASE-NEURR881FKY\nCASE-NEURT008RBN\nCASE-NEURT785NE0\nCASE-NEURX315DYH\nCASE-NEURX909UL6\nCASE-NEUTA057AF6\nCASE-NEUTB230DA3\nCASE-NEUTC791PVE\nCASE-NEUTD314VFT\nCASE-NEUTD866EAH\nCASE-NEUTJ613AH9\nCASE-NEUTJ673HVL\nCASE-NEUTK103LA2\nCASE-NEUTL257PNR\nCASE-NEUTL699WJ0\nCASE-NEUTM459HZV\nCASE-NEUTM934BPY\nCASE-NEUTU360YJY\nCASE-NEUTU977EF8\nCASE-NEUTV502UXV\nCASE-NEUTY409FWN\nCASE-NEUTZ197WN7\nCASE-NEUUC458RFT\nCASE-NEUUD158CJF\nCASE-NEUUE852BB1\nCASE-NEUUF177PR6\nCASE-NEUUF613PHL\nCASE-NEUUH658EYH\nCASE-NEUUJ507EAB\nCASE-NEUUK960PF7\nCASE-NEUUL256UC9\nCASE-NEUUL292XRC\nCASE-NEUUL311NRQ\nCASE-NEUUP280KXL\nCASE-NEUUU506WZF\nCASE-NEUUX639XV0\nCASE-NEUUZ216XY8\nCASE-NEUUZ691KHN\nCASE-NEUVD687XD8\nCASE-NEUVF488XCF\nCASE-NEUVP060WFG\nCASE-NEUVR636VTP\nCASE-NEUVR711TBR\nCASE-NEUVR814YCY\nCASE-NEUVU735HU6\nCASE-NEUVV115HWH\nCASE-NEUVV225XKB\nCASE-NEUVW680LPK\nCASE-NEUVW999FP9\nCASE-NEUVX902YNL\nCASE-NEUVY234LVB\nCASE-NEUWD538KT3\nCASE-NEUWD781PHK\nCASE-NEUWD946RDA\nCASE-NEUWH380YHV\nCASE-NEUWH955FJF\nCASE-NEUWJ389FC7\nCASE-NEUWL486NRA\nCASE-NEUWM344ZLM\nCASE-NEUWN755ZP7\nCASE-NEUWV328FFB\nCASE-NEUWX167DAH\nCASE-NEUWY079WUH\nCASE-NEUWZ387HEM\nCASE-NEUWZ614ARQ\nCASE-NEUWZ822EZ3\nCASE-NEUXC114JYA\nCASE-NEUXD265LJ8\nCASE-NEUXD985ZU1\nCASE-NEUXG265ME9\nCASE-NEUXH833LL4\nCASE-NEUXP246TBM\nCASE-NEUXP289KRC\nCASE-NEUXP369PXA\nCASE-NEUXP495XE2\nCASE-NEUXV122FN3\nCASE-NEUXW790VZK\nCASE-NEUXZ486GG5\nCASE-NEUXZ835CZN\nCASE-NEUYB991JTA\nCASE-NEUYC055XPZ\nCASE-NEUYC198DCR\nCASE-NEUYC303AJY\nCASE-NEUYC651BR2\nCASE-NEUYD306HAB\nCASE-NEUYG208KVV\nCASE-NEUYG298CA9\nCASE-NEUYG636WT7\nCASE-NEUYH924UCE\nCASE-NEUYJ400MGQ\nCASE-NEUYJ705VN9\nCASE-NEUYK012ATK\nCASE-NEUYK029WUU\nCASE-NEUYP226CPW\nCASE-NEUYP235ZLD\nCASE-NEUYR183FYF\nCASE-NEUYT193FFG\nCASE-NEUYY061XMC\nCASE-NEUYY493DR8\nCASE-NEUYY614DN8\nCASE-NEUYY878JGP\nCASE-NEUYZ462TBW\nCASE-NEUZD231YZ6\nCASE-NEUZE432DZM\nCASE-NEUZE814JZF\nCASE-NEUZF321EW4\nCASE-NEUZF473UEP\nCASE-NEUZG964FAV\nCASE-NEUZK054DP5\nCASE-NEUZN936HJ9\nCASE-NEUZP278MR4\nCASE-NEUZP572KEZ\nCASE-NEUZR615PKX\nCASE-NEUZT902WVB\nCASE-NEUZV656DD1\nCASE-NEUZW291KJY\nCASE-NEUZW701NNF\nCASE-NEUZW744ZCD\nCASE-NEUZX521TKK\nCASE-NEUZX663FZ2\nCASE-NEUZX847VWV\nCASE-NEUZY128BJ2\nCASE-NEUZY264DG9\nCASE-NEUZY975XKL\nCTRL-CS007\nCTRL-CW50002FF1\nCTRL-CW50021EE1\nCTRL-CW50027\nCTRL-EDi021A\nCTRL-EDi022A\nCTRL-EDi023A\nCTRL-EDi025A\nCTRL-EDi026A\nCTRL-EDi029A\nCTRL-EDi030A\nCTRL-EDi038A\nCTRL-EDi039A\nCTRL-EDi043A\nCTRL-EDi045A\nCTRL-NEUAA485DZL\nCTRL-NEUAG120VWW\nCTRL-NEUAJ928PAA\nCTRL-NEUAK915RW7\nCTRL-NEUAN478ZLW\nCTRL-NEUBU578NX3\nCTRL-NEUCA748GF2\nCTRL-NEUCE403VM7\nCTRL-NEUCV136DHM\nCTRL-NEUCV809LL4\nCTRL-NEUCX966RX5\nCTRL-NEUDA782GW3\nCTRL-NEUDD665KML\nCTRL-NEUDF148BTJ\nCTRL-NEUDG422NK3\nCTRL-NEUDM126GNG\nCTRL-NEUDT762KUL\nCTRL-NEUDV570JJM\nCTRL-NEUEA702XRF\nCTRL-NEUEB210XRC\nCTRL-NEUEK795BLX\nCTRL-NEUET121DA6\nCTRL-NEUEU392AE8\nCTRL-NEUFK653ZB3\nCTRL-NEUFL733GX5\nCTRL-NEUFU823AF8\nCTRL-NEUGM959DE2\nCTRL-NEUHY905BUE\nCTRL-NEUJH928PGD\nCTRL-NEUJX341NDP\nCTRL-NEULM159CPG\nCTRL-NEUMA002VLD\nCTRL-NEUMC455JAR\nCTRL-NEUMF089KLV\nCTRL-NEUMF196GPV\nCTRL-NEUML507PFJ\nCTRL-NEUML965NXH\nCTRL-NEUMR377JKP\nCTRL-NEUMT184NWC\nCTRL-NEUMV031UD8\nCTRL-NEUNB744CAL\nCTRL-NEUNC876ZB2\nCTRL-NEUNK457XYH\nCTRL-NEUNN472ACB\nCTRL-NEUNW343RXP\nCTRL-NEUPH301NNX\nCTRL-NEUPL878MTL\nCTRL-NEUPM433ADK\nCTRL-NEUPW469XH7\nCTRL-NEUPW536ZKZ\nCTRL-NEUPY789JV6\nCTRL-NEURV546WMW\nCTRL-NEUTD932VFY\nCTRL-NEUTY704UY9\nCTRL-NEUTZ821KW9\nCTRL-NEUUV825HYF\nCTRL-NEUUX563RM1\nCTRL-NEUVW301WP3\nCTRL-NEUVX248UJQ\nCTRL-NEUWN092BVG\nCTRL-NEUWT164JRQ\nCTRL-NEUXC258VTR\nCTRL-NEUXC738FB0\nCTRL-NEUXP955XW7\nCTRL-NEUXU356GN0\nCTRL-NEUXW311EFC\nCTRL-NEUXY894VJR\nCTRL-NEUZA664DNH\nCTRL-NEUZG048FP5\nCTRL-NEUZL045YD3\nCTRL-NEUZX866LAD\nCTRL-W14C179\nCTRL-W14C180\nCTRL-W15C201\nCTRL-W15C202\nCTRL-W16C403"
    ],
}


# SQL TPM data function
def tpm_sql_query(gene_set, participant):
    participant = "\n".join(
        list(
            set(
                _participant_list[general_widgets.dataset_button.v_model][0].split("\n")
            ).intersection(list(set(participant.split("\n"))))
        )
    )
    # participant_input.value=participant
    sql = (
        "SELECT "
        + ",".join(("[" + participant.replace("\n", "],[") + "]").split(","))
        + ",gene_id"
        + " FROM dbo.data WHERE gene_id in %s"
        % repr(tuple(map(str, gene_set.replace("\n", ",").split(","))))
    )
    # Run SQL
    sql_query = pd.read_sql(sql, engine)
    # Convert SQL to DataFrame
    df_selected = pd.DataFrame(sql_query)
    df_selected = df_selected.set_index("gene_id")
    df_selected = df_selected.astype(float)
    return df_selected


# deseq on the fly query
def de_fly_query(gene_set, participant):
    participant = "\n".join(
        list(
            set(
                _participant_list[general_widgets.dataset_button.v_model][0].split("\n")
            ).intersection(list(set(participant.split("\n"))))
        )
    )
    # participant_input.value=participant
    sql = (
        "SELECT "
        + ",".join(("[" + participant.replace("\n", "],[") + "]").split(","))
        + ",gene_id,Ensembl_ID"
        + " FROM dbo.data_raw WHERE gene_id in %s"
        % repr(tuple(map(str, gene_set.replace("\n", ",").split(","))))
    )
    # Run SQL
    sql_query = pd.read_sql(sql, engine)
    # Convert SQL to DataFrame
    df_selected = pd.DataFrame(sql_query)
    df_selected.drop("gene_id", inplace=True, axis=1)
    df_selected = df_selected.set_index("Ensembl_ID")
    df_selected = df_selected.astype(float)

    # select gene ids from gene id_ensembl.csv
    gene_id_sql = "SELECT * FROM dbo.ensembl_gene_ids WHERE geneids in %s" % repr(
        tuple(map(str, gene_set.replace("\n", ",").split(",")))
    )
    sql_query = pd.read_sql(gene_id_sql, engine)
    # Convert SQL to DataFrame
    gene_ids = pd.DataFrame(sql_query)
    return df_selected, gene_ids


# SQL DE data function
def de_sql_query(gene_set):
    # Run SQL
    de_sql = "SELECT * FROM dbo.data_de WHERE gene_id in %s" % repr(
        tuple(map(str, gene_set.replace("\n", ",").split(",")))
    )
    sql_query = pd.read_sql(de_sql, engine)
    # Convert SQL to DataFrame
    df_selected = pd.DataFrame(sql_query)
    return df_selected


# SQL Covariates function
def cov_sql_query(covariate):
    if isinstance(covariate, list):
        cov_sql = (
            "SELECT Participant_ID,"
            + ",".join(covariate)
            + " FROM dbo.covariates WHERE Participant_ID in %s"
            % repr(
                tuple(
                    map(
                        str,
                        general_widgets.participant_input.v_model.replace(
                            "\n", ","
                        ).split(","),
                    )
                )
            )
        )
        sql_query = pd.read_sql(cov_sql, engine)
        # Convert SQL to DataFrame
        covariates = pd.DataFrame(sql_query)
        covariates = covariates.set_index("Participant_ID")
        return covariates
    else:
        cov_sql = (
            "SELECT Participant_ID,"
            + covariate
            + " FROM dbo.covariates WHERE Participant_ID in %s"
            % repr(
                tuple(
                    map(
                        str,
                        general_widgets.participant_input.v_model.replace(
                            "\n", ","
                        ).split(","),
                    )
                )
            )
        )
        sql_query = pd.read_sql(cov_sql, engine)
        # Convert SQL to DataFrame
        covariates = pd.DataFrame(sql_query)
        covariates = covariates.set_index("Participant_ID")
        return covariates


# Proteomics
# SQL PROTEOMICS data function
def protein_sql_query(protein_set, participant):
    participant = "\n".join(
        list(
            set(_participant_list["Proteomics"][0].split("\n")).intersection(
                list(set(participant.split("\n")))
            )
        )
    )
    # participant_input.value=participant
    sql = (
        "SELECT "
        + ",".join(("[" + participant.replace("\n", "],[") + "]").split(","))
        + ",Protein_ID"
        + " FROM dbo.protein_level WHERE Protein_ID in %s"
        % repr(tuple(map(str, protein_set.replace("\n", ",").split(","))))
    )
    # Run SQL
    sql_query = pd.read_sql(sql, engine)
    # Convert SQL to DataFrame
    df_selected = pd.DataFrame(sql_query)
    df_selected = df_selected.set_index("Protein_ID")
    df_selected = df_selected.astype(float)
    return df_selected


# SQL DE data function
def protein_de_sql_query(protein_set):
    # Run SQL
    de_sql = "SELECT * FROM dbo.protein_de WHERE Protein_ID in %s" % repr(
        tuple(map(str, protein_set.replace("\n", ",").split(",")))
    )
    sql_query = pd.read_sql(de_sql, engine)
    # Convert SQL to DataFrame
    df_selected = pd.DataFrame(sql_query)
    return df_selected
